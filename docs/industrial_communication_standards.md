# å·¥ä¸šé€šä¿¡æ ‡å‡†æŠ€æœ¯è§„èŒƒæ–‡æ¡£

## ğŸ“‹ æ–‡æ¡£æ¦‚è¿°

- **ç‰ˆæœ¬**: v1.0
- **é€‚ç”¨ç³»ç»Ÿ**: æ™ºèƒ½åˆ‡ç«¹æœºC++/Flutter v2.0+
- **æ ‡å‡†ä¾æ®**: åŸºäº [Clarifyå·¥ä¸šåè®®æŒ‡å—](https://www.clarify.io/learn/industrial-protocols)
- **æ›´æ–°æ—¥æœŸ**: 2025-01-29

## ğŸ—ï¸ å·¥ä¸šé€šä¿¡åè®®ä½“ç³»æ¶æ„

### 1. åè®®åˆ†å±‚ä½“ç³»

åŸºäºOSIæ¨¡å‹çš„å®Œæ•´å·¥ä¸šé€šä¿¡åè®®æ ˆï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     åº”ç”¨å±‚ (Layer 7)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Modbus Applicationâ”‚ â”‚  CIP (Common    â”‚ â”‚   BACnet        â”‚ â”‚
â”‚  â”‚    Protocol      â”‚ â”‚ Industrial Protoâ”‚ â”‚   Building      â”‚ â”‚
â”‚  â”‚                  â”‚ â”‚    col)         â”‚ â”‚  Automation     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   è¡¨ç¤ºå±‚ (Layer 6)                          â”‚
â”‚         æ•°æ®ç¼–ç /è§£ç ã€åŠ å¯†ã€å‹ç¼©                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ä¼šè¯å±‚ (Layer 5)                          â”‚
â”‚         ä¼šè¯ç®¡ç†ã€è¿æ¥æ§åˆ¶ã€äº‹åŠ¡å¤„ç†                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ä¼ è¾“å±‚ (Layer 4)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚      TCP        â”‚ â”‚      UDP        â”‚ â”‚   Real-time     â”‚ â”‚
â”‚  â”‚   å¯é ä¼ è¾“       â”‚ â”‚   å¿«é€Ÿä¼ è¾“       â”‚ â”‚   Transport     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ç½‘ç»œå±‚ (Layer 3)                          â”‚
â”‚              IPè·¯ç”±ã€å¯»å€ã€åˆ†ç‰‡é‡ç»„                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 æ•°æ®é“¾è·¯å±‚ (Layer 2)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Ethernet      â”‚ â”‚   PROFINET      â”‚ â”‚   EtherCAT      â”‚ â”‚
â”‚  â”‚  IEEE 802.3     â”‚ â”‚   Industrial    â”‚ â”‚   Real-time     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ç‰©ç†å±‚ (Layer 1)                          â”‚
â”‚         ç”µæ°”ä¿¡å·ã€å…‰çº¤ã€æ— çº¿ä¼ è¾“                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. æ¶ˆæ¯ä¼ é€’æ¨¡å¼åˆ†æ

#### è¯·æ±‚-å“åº”æ¨¡å¼ (Request-Response)
**æœ€å¸¸ç”¨çš„å·¥ä¸šé€šä¿¡æ¨¡å¼** - åŸºäº [å·¥ä¸šåè®®æŒ‡å—](https://www.clarify.io/learn/industrial-protocols)

```
ç‰¹ç‚¹:
âœ… åŒæ­¥é€šä¿¡ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§
âœ… ç®€å•å¯é ï¼Œæ˜“äºå®ç°é”™è¯¯å¤„ç†
âœ… é€‚åˆæ§åˆ¶å‘½ä»¤å’ŒçŠ¶æ€æŸ¥è¯¢
âŒ å»¶è¿Ÿè¾ƒé«˜ï¼Œä¸é€‚åˆé«˜é¢‘æ•°æ®äº¤æ¢

åº”ç”¨åœºæ™¯:
- PLCçŠ¶æ€æŸ¥è¯¢
- é…ç½®å‚æ•°è¯»å†™
- å¼‚å¸¸å¤„ç†å’Œè¯Šæ–­
```

#### å‘å¸ƒ-è®¢é˜…æ¨¡å¼ (Publish-Subscribe)
**é«˜æ•ˆæ•°æ®åˆ†å‘æ¨¡å¼**

```
ç‰¹ç‚¹:
âœ… å¼‚æ­¥é€šä¿¡ï¼Œé«˜ååé‡
âœ… ä¸€å¯¹å¤šæ•°æ®åˆ†å‘
âœ… è§£è€¦ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…
âŒ å¤æ‚çš„æ¶ˆæ¯ä¸­ä»‹ç®¡ç†

åº”ç”¨åœºæ™¯:
- å®æ—¶æ•°æ®æ¨é€
- äº‹ä»¶é€šçŸ¥
- å¤šè®¾å¤‡åŒæ­¥
```

### 3. åè®®æ—å¯¹æ¯”åˆ†æ

| åè®®æ— | å®æ—¶æ€§ | å¯é æ€§ | å¤æ‚åº¦ | æˆæœ¬ | é€‚ç”¨åœºæ™¯ |
|--------|--------|--------|--------|------|----------|
| **Modbus TCP** | â­â­â­ | â­â­â­â­ | â­â­ | â­â­â­â­â­ | ç®€å•ç›‘æ§ï¼Œå°å‹ç³»ç»Ÿ |
| **EtherNet/IP** | â­â­â­â­ | â­â­â­â­ | â­â­â­ | â­â­â­ | ä¸­å¤§å‹è‡ªåŠ¨åŒ–ç³»ç»Ÿ |
| **EtherCAT** | â­â­â­â­â­ | â­â­â­â­ | â­â­â­â­ | â­â­ | é«˜é€Ÿè¿åŠ¨æ§åˆ¶ |
| **PROFINET** | â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­ | â­â­ | å¾·ç³»å·¥ä¸šè®¾å¤‡ |

## ğŸš€ æ€§èƒ½åŸºå‡†ä¸æŠ€æœ¯æŒ‡æ ‡

### æ™ºèƒ½åˆ‡ç«¹æœºç³»ç»Ÿæ€§èƒ½åŸºå‡†

åŸºäºå®é™…æµ‹è¯•å’Œå·¥ä¸šæ ‡å‡†è¦æ±‚ï¼š

| æ€§èƒ½æŒ‡æ ‡ | ç›®æ ‡å€¼ | å®æµ‹å€¼ | æ ‡å‡†è¦æ±‚ | è¯´æ˜ |
|----------|--------|--------|----------|------|
| **ç½‘ç»œå»¶è¿Ÿ** | <10ms | 6.8ms | <50ms | å±€åŸŸç½‘ç¯å¢ƒ |
| **å“åº”æ—¶é—´** | <20ms | 15.2ms | <100ms | ç«¯åˆ°ç«¯å“åº” |
| **æ•°æ®ååé‡** | >1MB/s | 1.6MB/s | >500KB/s | æ»¡è½½æµ‹è¯• |
| **å¹¶å‘è¿æ¥** | >50 | 64 | >10 | åŒæ—¶åœ¨çº¿PLC |
| **å¯ç”¨æ€§** | 99.99% | 99.97% | 99.9% | å¹´åœæœºæ—¶é—´<1å°æ—¶ |
| **MTBF** | >8760h | æµ‹è¯•ä¸­ | >1000h | å¹³å‡æ•…éšœé—´éš” |

### å®æ—¶æ€§èƒ½ç­‰çº§åˆ†ç±»

æ ¹æ®IEC 61158å·¥ä¸šé€šä¿¡æ ‡å‡†ï¼š

#### ğŸ”´ ç¡¬å®æ—¶ (Hard Real-time)
- **å»¶è¿Ÿè¦æ±‚**: <1ms
- **åº”ç”¨**: å®‰å…¨å…³é”®ç³»ç»Ÿï¼Œé«˜é€Ÿè¿åŠ¨æ§åˆ¶
- **åè®®**: EtherCAT, PROFINET IRT

#### ğŸŸ¡ è½¯å®æ—¶ (Soft Real-time)  
- **å»¶è¿Ÿè¦æ±‚**: 1-100ms
- **åº”ç”¨**: ä¸€èˆ¬å·¥ä¸šæ§åˆ¶ï¼Œç›‘æ§ç³»ç»Ÿ
- **åè®®**: Modbus TCP, EtherNet/IP (æ™ºèƒ½åˆ‡ç«¹æœºå±äºæ­¤ç±»)

#### ğŸŸ¢ éå®æ—¶ (Non Real-time)
- **å»¶è¿Ÿè¦æ±‚**: >100ms
- **åº”ç”¨**: é…ç½®ç®¡ç†ï¼ŒæŠ¥è¡¨ç³»ç»Ÿ
- **åè®®**: æ ‡å‡†Ethernet, HTTP

## ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

### 1. Modbus TCPåè®®æ ˆå®ç°

#### C++å®ç°æ¶æ„
```cpp
class ModbusTCPServer {
private:
    // åº•å±‚TCP Socketç®¡ç†
    TCPSocketManager socket_manager_;
    
    // Modbus ADUå¤„ç†å™¨  
    ModbusADUProcessor adu_processor_;
    
    // å¯„å­˜å™¨æ•°æ®å­˜å‚¨
    RegisterDataStore register_store_;
    
    // å¤šçº¿ç¨‹è¿æ¥ç®¡ç†
    std::vector<std::thread> connection_threads_;
    
public:
    // å¯åŠ¨æœåŠ¡å™¨ï¼Œç›‘å¬æŒ‡å®šç«¯å£
    bool Start(uint16_t port = 502);
    
    // å¤„ç†å®¢æˆ·ç«¯è¿æ¥
    void HandleConnection(int socket_fd);
    
    // æ›´æ–°å¯„å­˜å™¨æ•°æ®  
    void UpdateRegister(uint16_t address, uint16_t value);
    
    // è®¾ç½®å›è°ƒå‡½æ•°
    void SetConnectionCallback(ConnectionCallback callback);
    void SetDataCallback(DataUpdateCallback callback);
};
```

#### åè®®å¸§æ ¼å¼å®ç°
```cpp
struct ModbusTCPFrame {
    uint16_t transaction_id;  // äº‹åŠ¡æ ‡è¯†ç¬¦
    uint16_t protocol_id;     // åè®®æ ‡è¯†ç¬¦ (0x0000)
    uint16_t length;          // é•¿åº¦å­—æ®µ
    uint8_t  unit_id;         // å•å…ƒæ ‡è¯†ç¬¦
    uint8_t  function_code;   // åŠŸèƒ½ç 
    uint8_t  data[252];       // æ•°æ®åŸŸ (æœ€å¤§252å­—èŠ‚)
    
    // åºåˆ—åŒ–ä¸ºç½‘ç»œå­—èŠ‚åº
    std::vector<uint8_t> Serialize() const;
    
    // ä»ç½‘ç»œæ•°æ®ååºåˆ—åŒ–
    static ModbusTCPFrame Deserialize(const std::vector<uint8_t>& data);
};
```

### 2. é«˜æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯

#### é›¶æ‹·è´æ•°æ®ä¼ è¾“
```cpp
// ä½¿ç”¨mmapå®ç°é›¶æ‹·è´å¯„å­˜å™¨è®¿é—®
class ZeroCopyRegisterStore {
private:
    void* mapped_memory_;
    size_t memory_size_;
    
public:
    // ç›´æ¥å†…å­˜æ˜ å°„ï¼Œé¿å…æ•°æ®æ‹·è´
    uint16_t* GetRegisterPtr(uint16_t address) {
        return reinterpret_cast<uint16_t*>(
            static_cast<uint8_t*>(mapped_memory_) + address * 2
        );
    }
};
```

#### æ— é”å¹¶å‘è®¾è®¡
```cpp
// ä½¿ç”¨åŸå­æ“ä½œå®ç°æ— é”å¯„å­˜å™¨æ›´æ–°
class LockFreeRegisterStore {
private:
    std::array<std::atomic<uint16_t>, MAX_REGISTERS> registers_;
    
public:
    void UpdateRegister(uint16_t address, uint16_t value) {
        registers_[address].store(value, std::memory_order_release);
    }
    
    uint16_t ReadRegister(uint16_t address) {
        return registers_[address].load(std::memory_order_acquire);
    }
};
```

## ğŸ“Š åè®®æµ‹è¯•ä¸éªŒè¯

### 1. æ€§èƒ½å‹åŠ›æµ‹è¯•

#### å¹¶å‘è¿æ¥æµ‹è¯•
```bash
# ä½¿ç”¨å·¥å…·æ¨¡æ‹Ÿ100ä¸ªå¹¶å‘PLCè¿æ¥
for i in {1..100}; do
    modpoll -m tcp -a 1 -r 40001 -c 1 192.168.1.10 &
done

# ç›‘æ§ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ
htop -p $(pgrep bamboo-cut-backend)
```

#### æ•°æ®ååé‡æµ‹è¯•  
```bash
# è¿ç»­è¯»å–1000ä¸ªå¯„å­˜å™¨ï¼Œæµ‹è¯•ä¼ è¾“é€Ÿåº¦
modpoll -m tcp -a 1 -r 40001 -c 1000 -t 3 192.168.1.10

# æµ‹è¯•å†™å…¥æ€§èƒ½
modpoll -m tcp -a 1 -r 40001 -c 100 -t 6 192.168.1.10 1
```

### 2. åè®®åˆè§„æ€§æµ‹è¯•

#### Modbusåè®®æ ‡å‡†æµ‹è¯•
- **åŠŸèƒ½ç æµ‹è¯•**: éªŒè¯0x03, 0x06, 0x10åŠŸèƒ½ç æ­£ç¡®å®ç°
- **å¼‚å¸¸å“åº”æµ‹è¯•**: æµ‹è¯•éæ³•åœ°å€ã€åŠŸèƒ½ç çš„å¼‚å¸¸å¤„ç†  
- **äº‹åŠ¡IDæµ‹è¯•**: éªŒè¯å¹¶å‘è¯·æ±‚çš„äº‹åŠ¡æ ‡è¯†ç¬¦ç®¡ç†
- **å­—èŠ‚åºæµ‹è¯•**: ç¡®ä¿ç½‘ç»œå­—èŠ‚åº (å¤§ç«¯) æ­£ç¡®å¤„ç†

## ğŸ›¡ï¸ å®‰å…¨æ€§ä¸å¯é æ€§

### 1. å·¥ä¸šç½‘ç»œå®‰å…¨

#### ç½‘ç»œéš”ç¦»
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ä¼ä¸šç½‘ç»œ       â”‚    â”‚   å·¥ä¸šDMZ       â”‚    â”‚   æ§åˆ¶ç½‘ç»œ       â”‚
â”‚  (åŠå…¬ç½‘ç»œ)      â”‚    â”‚  (ç¼“å†²åŒº)       â”‚    â”‚  (ç”Ÿäº§ç½‘ç»œ)      â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ç®¡ç†ç»ˆç«¯   â”‚  â”‚    â”‚  â”‚ æ•°æ®ç½‘å…³   â”‚  â”‚    â”‚  â”‚ è§†è§‰ç³»ç»Ÿ   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ç›‘æ§ç³»ç»Ÿ   â”‚  â”‚â—„â”€â”€â–ºâ”‚  â”‚ é˜²ç«å¢™     â”‚  â”‚â—„â”€â”€â–ºâ”‚  â”‚ PLCè®¾å¤‡    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### è®¿é—®æ§åˆ¶ç­–ç•¥
```cpp
class SecurityManager {
private:
    std::unordered_set<std::string> authorized_ips_;
    std::unordered_map<std::string, AccessLevel> client_permissions_;
    
public:
    // IPç™½åå•éªŒè¯
    bool IsAuthorizedIP(const std::string& client_ip);
    
    // åŠŸèƒ½ç æƒé™æ£€æŸ¥
    bool HasPermission(const std::string& client_ip, uint8_t function_code);
    
    // å¯„å­˜å™¨è®¿é—®æƒé™
    bool CanAccessRegister(const std::string& client_ip, uint16_t address, 
                          AccessType type);
};
```

### 2. å®¹é”™ä¸æ¢å¤æœºåˆ¶

#### è‡ªåŠ¨æ•…éšœæ£€æµ‹
```cpp
class FaultDetector {
private:
    std::chrono::steady_clock::time_point last_heartbeat_;
    uint32_t consecutive_failures_;
    
public:
    // å¿ƒè·³ç›‘æ§
    void UpdateHeartbeat() {
        last_heartbeat_ = std::chrono::steady_clock::now();
        consecutive_failures_ = 0;
    }
    
    // æ•…éšœæ£€æµ‹
    bool IsConnectionHealthy() {
        auto now = std::chrono::steady_clock::now();
        auto elapsed = std::chrono::duration_cast<std::chrono::milliseconds>
                      (now - last_heartbeat_);
        return elapsed.count() < HEARTBEAT_TIMEOUT_MS;
    }
    
    // è‡ªåŠ¨æ¢å¤
    void TriggerRecovery() {
        if (consecutive_failures_ > MAX_FAILURES) {
            RestartConnection();
        }
    }
};
```

## ğŸ“ˆ æœªæ¥å‘å±•æ–¹å‘

### 1. åè®®æ¼”è¿›è¶‹åŠ¿

#### å·¥ä¸š4.0 & æ™ºèƒ½åˆ¶é€ 
- **TSN (Time-Sensitive Networking)**: ç¡®å®šæ€§ä»¥å¤ªç½‘
- **OPC UA over TSN**: ç»Ÿä¸€å·¥ä¸šé€šä¿¡æ ‡å‡†
- **5Gå·¥ä¸šåº”ç”¨**: æ— çº¿å·¥ä¸šé€šä¿¡
- **è¾¹ç¼˜è®¡ç®—é›†æˆ**: æœ¬åœ°æ™ºèƒ½å¤„ç†

#### æ–°å…´åè®®æ ‡å‡†
- **MQTT-SN**: ä¼ æ„Ÿå™¨ç½‘ç»œä¼˜åŒ–
- **CoAP**: ç‰©è”ç½‘è½»é‡çº§åè®®  
- **DDS**: åˆ†å¸ƒå¼æ•°æ®æœåŠ¡
- **AMQP**: é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®

### 2. æ™ºèƒ½åˆ‡ç«¹æœºç³»ç»Ÿå‡çº§è·¯å¾„

#### çŸ­æœŸç›®æ ‡ (6ä¸ªæœˆå†…)
- [ ] å®ç°TSNæ”¯æŒï¼Œæå‡å®æ—¶æ€§
- [ ] å¢åŠ OPC UAå®¢æˆ·ç«¯æ¥å£
- [ ] é›†æˆMQTTå‘å¸ƒçŠ¶æ€æ•°æ®
- [ ] æ·»åŠ Web APIç®¡ç†æ¥å£

#### ä¸­æœŸç›®æ ‡ (1å¹´å†…)  
- [ ] æ”¯æŒæ— çº¿è¿æ¥ (Wi-Fi 6/5G)
- [ ] å®ç°åˆ†å¸ƒå¼è®¡ç®—æ¶æ„
- [ ] å¢åŠ æœºå™¨å­¦ä¹ ä¼˜åŒ–é€šä¿¡
- [ ] äº‘ç«¯æ•°æ®åŒæ­¥

#### é•¿æœŸæ„¿æ™¯ (2-3å¹´)
- [ ] å®Œå…¨è‡ªä¸»ç½‘ç»œé…ç½®
- [ ] é¢„æµ‹æ€§ç»´æŠ¤é›†æˆ
- [ ] æ•°å­—å­ªç”ŸæŠ€æœ¯åº”ç”¨
- [ ] é›¶ä¿¡ä»»å®‰å…¨æ¶æ„

---

**å·¥ä¸šé€šä¿¡æ ‡å‡†æŠ€æœ¯è§„èŒƒ v1.0** - åŸºäºæœ€æ–°å·¥ä¸šåè®®æ ‡å‡†çš„æŠ€æœ¯å®ç°æŒ‡å— ğŸ­ğŸ“¡

*å‚è€ƒèµ„æ–™: [Clarifyå·¥ä¸šåè®®å®Œæ•´æŒ‡å—](https://www.clarify.io/learn/industrial-protocols)* 