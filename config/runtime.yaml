# Runtime configuration for bamboo_vision.py

camera:
  # CSI default; override with a full GStreamer pipeline if needed.
  pipeline: "csi://0"
  width: 1280
  height: 720

model:
  onnx: "models/best.onnx"
  engine: "models/best.engine"   # optional; leave blank to build on first run
  labels: "config/labels.txt"     # optional labels.txt
  threshold: 0.50
  nms: 0.45
  input_blob: "images"            # YOLOv8 default
  output_bbox: "output0"          # YOLOv8 default output

calibration:
  pixel_to_mm: 1.0      # placeholder; replace after calibration
  offset_mm: 0.0
  latency_ms: 0.0
  belt_speed_mm_s: 0.0

modbus:
  host: "192.168.1.100"
  port: 502
  slave_id: 1
  poll_ms: 50
  write_heartbeat_ms: 20
  addr_cam_to_plc:
    comm: 0x07D0    # D2000
    status: 0x07D1  # D2001
    coord: 0x07D2   # D2002 (float hi/lo)
    result: 0x07D4  # D2004
  addr_plc_to_cam:
    heartbeat: 0x0834  # D2100
    state: 0x0835      # D2101 (1=ready for coordinate; 2=feeding)
    servo_pos: 0x0836  # D2102 (float hi/lo)

output:
  hdmi: true
  rtsp: false            # NVENC 缺失时关闭内置 RTSP，使用 raw_udp + 外部软编
  rtsp_uri: "rtsp://@:8554/live"
  raw_udp: false         # 若需外部软编推流，改为 true 并用下方端口
  raw_udp_host: "127.0.0.1"
  raw_udp_port: 5600

app:
  publish_interval_ms: 100

http:
  enable: true
  host: "0.0.0.0"
  port: 8080
