# æ™ºèƒ½ç«¹æåˆ‡å‰²ç³»ç»Ÿ v3.0 - ä¸€ä½“åŒ–æ¶æ„ç‰ˆ

åŸºäºC++å’ŒLVGLçš„é«˜æ€§èƒ½å·¥ä¸šçº§ç«¹æåˆ‡å‰²ç³»ç»Ÿï¼Œé‡‡ç”¨å•è¿›ç¨‹ä¸€ä½“åŒ–æ¶æ„ï¼Œæ”¯æŒTensorRT GPUåŠ é€Ÿå’ŒJetson Orin NXéƒ¨ç½²ã€‚

## ğŸš€ v3.0 é‡å¤§æ›´æ–°

### ä¸€ä½“åŒ–æ¶æ„ (NEW!)
- **å•è¿›ç¨‹è®¾è®¡**: å‰åç«¯å®Œå…¨æ•´åˆï¼Œæ¶ˆé™¤IPCé€šä¿¡å¼€é”€
- **çº¿ç¨‹å®‰å…¨æ•°æ®æ¡¥æ¥**: é«˜æ•ˆçš„æ¨ç†çº¿ç¨‹ä¸UIçº¿ç¨‹æ•°æ®äº¤æ¢
- **é›¶æ‹·è´ä¼˜åŒ–**: è§†é¢‘å¸§å’Œæ£€æµ‹ç»“æœçš„å†…å­˜é›¶æ‹·è´ä¼ è¾“
- **ç»Ÿä¸€æ„å»ºç³»ç»Ÿ**: ä¸€é”®æ„å»ºå’Œéƒ¨ç½²ï¼Œç®€åŒ–è¿ç»´å¤æ‚åº¦

### ğŸ¯ æ ¸å¿ƒç‰¹æ€§

- **ğŸš€ é«˜æ€§èƒ½C++åç«¯**: TensorRT GPUåŠ é€ŸAIæ¨ç†ï¼Œæå‡3-5å€æ€§èƒ½
- **ğŸ“± LVGLåµŒå…¥å¼å‰ç«¯**: åŸç”ŸåµŒå…¥å¼GUIï¼Œå®Œç¾é€‚é…è§¦å±å’Œæ˜¾ç¤ºå™¨
- **ğŸ”§ ç¡¬ä»¶åŠ é€Ÿ**: GStreamer + DeepStreamæ‘„åƒå¤´ç¡¬ä»¶åŠ é€Ÿ
- **âš¡ æ¨¡å‹ä¼˜åŒ–**: é›†æˆGhostConvã€GSConvã€VoV-GSCSPã€NAMè½»é‡åŒ–æŠ€æœ¯
- **ğŸŒ è·¨å¹³å°æ”¯æŒ**: x86_64 å’Œ ARM64 (Jetson) åŒæ¶æ„éƒ¨ç½²
- **ğŸ“¡ é«˜æ•ˆé€šä¿¡**: Modbus TCPæœåŠ¡å™¨ï¼Œæ”¯æŒPLCå¹¶å‘è¿æ¥
- **ğŸ”— ä¸€ä½“åŒ–éƒ¨ç½²**: å•ä¸€å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè‡ªåŠ¨ä¾èµ–ç®¡ç†

## ğŸ“Š æ€§èƒ½åŸºå‡†

### Jetson Orin NX (ä¸€ä½“åŒ–æ¶æ„)
- **AIæ¨ç†**: 35+ FPS, <28mså»¶è¿Ÿ
- **æ‘„åƒå¤´**: 30 FPS, <12mså»¶è¿Ÿ  
- **UIå“åº”**: 60 FPS, <16mså»¶è¿Ÿ
- **ç³»ç»Ÿè´Ÿè½½**: CPU <25%, å†…å­˜ <800MB
- **å¯åŠ¨æ—¶é—´**: <5ç§’ (vs åŸ15ç§’åŒè¿›ç¨‹)

### x86_64 å·¥æ§æœº
- **AIæ¨ç†**: 20+ FPS, <50mså»¶è¿Ÿ
- **ç³»ç»Ÿè´Ÿè½½**: CPU <40%, å†…å­˜ <1.5GB

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### ä¸€ä½“åŒ–è¿›ç¨‹æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                bamboo_integrated (å•è¿›ç¨‹)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   æ¨ç†å·¥ä½œçº¿ç¨‹        â”‚    æ•°æ®æ¡¥æ¥å™¨         â”‚   LVGL UIçº¿ç¨‹    â”‚
â”‚                    â”‚                     â”‚                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ CameraManager   â”‚ â”‚  â”‚ VideoData       â”‚ â”‚ â”‚ VideoView   â”‚ â”‚
â”‚  â”‚ BambooDetector  â”‚ â”‚  â”‚ DetectionData   â”‚ â”‚ â”‚ StatusBar   â”‚ â”‚
â”‚  â”‚ StereoVision    â”‚â—„â”¼â”€â–ºâ”‚ SystemStats     â”‚â—„â”¼â”€â–ºâ”‚ ControlPanelâ”‚ â”‚
â”‚  â”‚ ModbusServer    â”‚ â”‚  â”‚ (çº¿ç¨‹å®‰å…¨)       â”‚ â”‚ â”‚ SettingsPageâ”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æµæ¶æ„
```
æ‘„åƒå¤´ â†’ AIå¼•æ“ â†’ æ•°æ®æ¡¥æ¥å™¨ â†’ LVGLç•Œé¢
   â†“       â†“         â†“          â†‘
ç«‹ä½“è§†è§‰ â†’ æ£€æµ‹ç»“æœ â†’ çº¿ç¨‹åŒæ­¥ â†’ ç”¨æˆ·äº¤äº’
   â†“       â†“         â†“          â†‘
åæ ‡è®¡ç®— â†’ Modbus â†’ çŠ¶æ€æ›´æ–° â†’ è§¦æ‘¸æ§åˆ¶
```

## ğŸ“¡ PLCé€šä¿¡åè®®

åŸºäº**Modbus TCP**çš„é«˜æ€§èƒ½å·¥ä¸šé€šä¿¡ï¼Œé‡‡ç”¨"è§†è§‰æ¨é€ï¼ŒPLCè½®è¯¢"çš„æ•°æ®äº¤æ¢æ¨¡å¼ã€‚

### ğŸ”— é€šä¿¡æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     Modbus TCP      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       PLC       â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚   è§†è§‰ç³»ç»Ÿ       â”‚
â”‚   (å®¢æˆ·ç«¯)       â”‚    192.168.1.10     â”‚ (ä¸€ä½“åŒ–æœåŠ¡ç«¯)    â”‚
â”‚                 â”‚      ç«¯å£:502       â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### â±ï¸ é€šä¿¡æ—¶åºæµç¨‹

#### 1. è¿æ¥å»ºç«‹ä¸å¿ƒè·³ç»´æŒ
```
PLC â†’ è§†è§‰ç³»ç»Ÿ: TCPè¿æ¥ (192.168.1.10:502)
PLC â†’ è§†è§‰ç³»ç»Ÿ: å¿ƒè·³å†™å…¥ (40001å¯„å­˜å™¨, æ¯2ç§’)
è§†è§‰ç³»ç»Ÿ â†’ å†…éƒ¨: ç›‘æ§å¿ƒè·³å˜åŒ–ï¼Œæ›´æ–°è¿æ¥çŠ¶æ€
```

#### 2. æ•°æ®æ¨é€ä¸è½®è¯¢
```
æ‘„åƒå¤´ â†’ AIå¼•æ“: å®æ—¶è§†é¢‘æµ
AIå¼•æ“ â†’ ModbusæœåŠ¡: æ¨é€æ£€æµ‹ç»“æœ
ModbusæœåŠ¡: æ›´æ–°åæ ‡å¯„å­˜å™¨ (40101-40148)
ModbusæœåŠ¡: è®¾ç½®å°±ç»ªæ ‡å¿— (40148=1)

å¾ªç¯è½®è¯¢:
PLC â†’ è§†è§‰ç³»ç»Ÿ: è¯»å–å°±ç»ªæ ‡å¿— (40148)
å¦‚æœ å°±ç»ªæ ‡å¿—=1:
    PLC â†’ è§†è§‰ç³»ç»Ÿ: è¯»å–åæ ‡æ•°æ® (40101-40147)
    PLC â†’ è§†è§‰ç³»ç»Ÿ: æ¸…é™¤å°±ç»ªæ ‡å¿— (40148=0)
```

#### 3. PLCæŒ‡ä»¤å¤„ç†
```
PLC â†’ è§†è§‰ç³»ç»Ÿ: å†™å…¥æŒ‡ä»¤ç  (40003å¯„å­˜å™¨)
è§†è§‰ç³»ç»Ÿ: è¯»å–å¹¶å¤„ç†æŒ‡ä»¤
è§†è§‰ç³»ç»Ÿ: æ¸…é™¤æŒ‡ä»¤ç  (40003=0)
è§†è§‰ç³»ç»Ÿ: æ‰§è¡Œç›¸åº”åŠ¨ä½œ (é€æ–™/åˆ‡å‰²/æ€¥åœç­‰)
```

### ğŸ“Š æ ¸å¿ƒå¯„å­˜å™¨æ˜ å°„

| å¯„å­˜å™¨ | åŠŸèƒ½ | ç±»å‹ | è¯´æ˜ |
|--------|------|------|------|
| 40001 | PLCå¿ƒè·³è®¡æ•°å™¨ | UINT16 | PLCæ¯2ç§’é€’å¢ |
| 40002 | è§†è§‰ç³»ç»ŸçŠ¶æ€ | UINT16 | 0=åˆå§‹åŒ–, 100=å°±ç»ª, 200+=é”™è¯¯ |
| 40003 | PLCæŒ‡ä»¤å¯„å­˜å™¨ | UINT16 | 1=é€æ–™, 3=åˆ‡å‰², 99=æ€¥åœ |
| 40101 | åˆ‡ç‚¹æ•°é‡ | UINT16 | æ£€æµ‹åˆ°çš„åˆ‡ç‚¹æ•°é‡(0-10) |
| 40102+ | åæ ‡æ•°æ® | FLOAT32 | IEEE754æ ¼å¼ï¼Œå•ä½:mm |
| 40148 | åæ ‡å°±ç»ªæ ‡å¿— | UINT16 | 1=æ–°æ•°æ®, PLCè¯»å–åæ¸…é›¶ |

### ğŸš€ æ€§èƒ½ç‰¹æ€§

- **å“åº”å»¶è¿Ÿ**: < 8ms (ä¸€ä½“åŒ–ä¼˜åŒ–)
- **å¹¶å‘æ”¯æŒ**: 10+ PLCåŒæ—¶è¿æ¥
- **æ•°æ®åå**: 1500+ åæ ‡/ç§’
- **å¯é æ€§**: å¿ƒè·³ç›‘æ§ + è‡ªåŠ¨é‡è¿

## ğŸ› ï¸ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

#### åŸºç¡€ä¾èµ–
```bash
# Ubuntu/Debianä¾èµ–
sudo apt update
sudo apt install build-essential cmake git pkg-config
sudo apt install libopencv-dev libgstreamer1.0-dev libmodbus-dev
sudo apt install nlohmann-json3-dev
```

#### Jetson Orin NXé¢å¤–ä¾èµ–
```bash
# Jetsonç‰¹å®šä¾èµ– 
sudo apt install nvidia-jetpack  # TensorRT + DeepStream
sudo apt install libcuda1 nvidia-cuda-toolkit
```

### ä¸€é”®éƒ¨ç½²

```bash
# 1. å…‹éš†é¡¹ç›®
git clone <repository-url>
cd banboo-develop

# 2. ä¸€é”®æ„å»ºå’Œéƒ¨ç½²
make deploy

# 3. éªŒè¯ç³»ç»ŸçŠ¶æ€
make status
make logs
```

### æ‰‹åŠ¨æ„å»º

```bash
# 1. åˆ›å»ºæ„å»ºç›®å½•
mkdir build_integrated && cd build_integrated

# 2. é…ç½®CMake (Jetson Orin NX)
cmake -DCMAKE_BUILD_TYPE=Release \
      -DENABLE_CUDA=ON \
      -DENABLE_TENSORRT=ON \
      -DCMAKE_CXX_FLAGS="-mcpu=cortex-a78 -O3" \
      ..

# 3. ç¼–è¯‘
make -j$(nproc)

# 4. å®‰è£…
sudo make install
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
banboo-develop/
â”œâ”€â”€ integrated_main.cpp          # ä¸€ä½“åŒ–ä¸»ç¨‹åº
â”œâ”€â”€ CMakeLists.txt               # ç»Ÿä¸€æ„å»ºé…ç½®
â”œâ”€â”€ Makefile                     # ä¸€ä½“åŒ–éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ config/                      # ç³»ç»Ÿé…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ system_config.yaml       # ä¸»é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ stereo_calibration.xml   # ç«‹ä½“è§†è§‰æ ‡å®š
â”‚   â””â”€â”€ performance_config.yaml  # æ€§èƒ½ä¼˜åŒ–é…ç½®
â”œâ”€â”€ cpp_backend/                 # C++åç«¯ç»„ä»¶
â”‚   â”œâ”€â”€ include/bamboo_cut/      # å¤´æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ vision/              # è§†è§‰æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ communication/       # é€šä¿¡æ¨¡å—
â”‚   â”‚   â””â”€â”€ core/                # æ ¸å¿ƒæ¨¡å—
â”‚   â””â”€â”€ src/                     # æºæ–‡ä»¶å®ç°
â”œâ”€â”€ lvgl_frontend/               # LVGLå‰ç«¯ç»„ä»¶
â”‚   â”œâ”€â”€ include/                 # å‰ç«¯å¤´æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ gui/                 # GUIç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ display/             # æ˜¾ç¤ºé©±åŠ¨
â”‚   â”‚   â””â”€â”€ input/               # è¾“å…¥é©±åŠ¨
â”‚   â””â”€â”€ src/                     # å‰ç«¯å®ç°
â”œâ”€â”€ models/                      # AIæ¨¡å‹æ–‡ä»¶
â”‚   â”œâ”€â”€ best.pt                  # YOLOv8æ¨¡å‹
â”‚   â””â”€â”€ convert_model.py         # æ¨¡å‹è½¬æ¢è„šæœ¬
â””â”€â”€ docs/                        # æŠ€æœ¯æ–‡æ¡£
```

## ğŸ”§ é…ç½®è¯´æ˜

### ç³»ç»Ÿé…ç½® (config/system_config.yaml)
```yaml
camera:
  width: 1920
  height: 1080
  fps: 30
  device: "/dev/video0"

ai:
  model_path: "./models/best.pt"
  confidence_threshold: 0.5
  use_tensorrt: true

modbus:
  ip: "0.0.0.0"
  port: 502
```

### æ€§èƒ½è°ƒä¼˜ (config/performance_config.yaml)
```yaml
threads:
  inference_priority: 10
  ui_priority: 5
  
memory:
  enable_memory_pool: true
  max_frame_buffer: 10

gpu:
  enable_zero_copy: true
  memory_fraction: 0.8
```

## ğŸ“‹ è¿ç»´ç®¡ç†

### ç³»ç»ŸæœåŠ¡

```bash
# å¯åŠ¨æœåŠ¡
sudo systemctl start bamboo-integrated
sudo systemctl enable bamboo-integrated

# æ£€æŸ¥çŠ¶æ€
sudo systemctl status bamboo-integrated

# æŸ¥çœ‹æ—¥å¿—
sudo journalctl -u bamboo-integrated -f
```

### ç›‘æ§å‘½ä»¤

```bash
# å®æ—¶æ€§èƒ½ç›‘æ§
make monitor

# ç³»ç»ŸçŠ¶æ€æ£€æŸ¥
make status

# æ—¥å¿—æŸ¥çœ‹
make logs

# é‡å¯æœåŠ¡
make restart
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **CUDAåº“æ‰¾ä¸åˆ°**
   ```bash
   # æ£€æŸ¥CUDAå®‰è£…
   ls /usr/local/cuda*/
   export LD_LIBRARY_PATH=/usr/local/cuda/lib64:$LD_LIBRARY_PATH
   ```

2. **TensorRTåˆå§‹åŒ–å¤±è´¥**
   ```bash
   # æ£€æŸ¥TensorRTç‰ˆæœ¬
   dpkg -l | grep tensorrt
   # é‡æ–°ç”Ÿæˆæ¨¡å‹æ–‡ä»¶
   python models/convert_model.py
   ```

3. **æ‘„åƒå¤´æ— æ³•è®¿é—®**
   ```bash
   # æ£€æŸ¥è®¾å¤‡æƒé™
   ls -la /dev/video*
   sudo usermod -a -G video $USER
   ```

4. **LVGLæ˜¾ç¤ºé—®é¢˜**
   ```bash
   # æ£€æŸ¥æ˜¾ç¤ºè®¾å¤‡
   export DISPLAY=:0
   # æ£€æŸ¥è§¦æ‘¸è®¾å¤‡
   ls /dev/input/event*
   ```

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add amazing feature'`)
4. æ¨é€åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. åˆ›å»º Pull Request

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰æŠ€æœ¯é—®é¢˜ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- ğŸ› **Bug æŠ¥å‘Š**: åœ¨ GitHub Issues ä¸­æäº¤
- ğŸ’¬ **æŠ€æœ¯è®¨è®º**: åœ¨ Discussions ä¸­å‘èµ·è¯é¢˜
- ğŸ“§ **å•†ä¸šæ”¯æŒ**: é€šè¿‡é‚®ä»¶è”ç³»æŠ€æœ¯å›¢é˜Ÿ

---

**ç‰ˆæœ¬**: v3.0.0-integrated  
**æ›´æ–°æ—¥æœŸ**: 2024å¹´9æœˆ  
**å…¼å®¹å¹³å°**: Jetson Orin NX, x86_64 Linux