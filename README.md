# æ™ºèƒ½åˆ‡ç«¹æœºç³»ç»Ÿ v2.0 - C++/Flutteré‡æ„ç‰ˆ

åŸºäºC++åç«¯å’ŒFlutterå‰ç«¯çš„é«˜æ€§èƒ½å·¥ä¸šçº§ç«¹æåˆ‡å‰²ç³»ç»Ÿï¼Œæ”¯æŒTensorRT GPUåŠ é€Ÿå’ŒåµŒå…¥å¼Linuxéƒ¨ç½²ã€‚

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æ™ºèƒ½åˆ‡ç«¹æœºç³»ç»Ÿv2.0æ˜¯ä»Pythonå…¨é¢é‡æ„ä¸ºC++/Flutterçš„å·¥ä¸šçº§è§£å†³æ–¹æ¡ˆï¼Œä¸“ä¸ºé«˜æ€§èƒ½ç”Ÿäº§ç¯å¢ƒè®¾è®¡ã€‚

### ğŸ¯ æ ¸å¿ƒç‰¹æ€§

- **ğŸš€ é«˜æ€§èƒ½C++åç«¯**: TensorRT GPUåŠ é€ŸAIæ¨ç†ï¼Œæå‡3-5å€æ€§èƒ½
- **ğŸ“± FlutteråµŒå…¥å¼å‰ç«¯**: å·¥ä¸šçº§è§¦å±ç•Œé¢ï¼Œå®Œç¾é€‚é…LXDEç¯å¢ƒ
- **ğŸ”§ ç¡¬ä»¶åŠ é€Ÿ**: GStreamer + DeepStreamæ‘„åƒå¤´ç¡¬ä»¶åŠ é€Ÿ
- **âš¡ æ¨¡å‹ä¼˜åŒ–**: é›†æˆGhostConvã€GSConvã€VoV-GSCSPã€NAMè½»é‡åŒ–æŠ€æœ¯
- **ğŸŒ è·¨å¹³å°æ”¯æŒ**: x86_64 å’Œ ARM64 (Jetson) åŒæ¶æ„éƒ¨ç½²
- **ğŸ“¡ é«˜æ•ˆé€šä¿¡**: C++å®ç°çš„Modbus TCPæœåŠ¡å™¨ï¼Œæ”¯æŒå¹¶å‘è¿æ¥

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„ä¸æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Flutter å‰ç«¯ç•Œé¢                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   å®æ—¶è§†é¢‘æ˜¾ç¤º   â”‚ â”‚   AIæ£€æµ‹ç»“æœ     â”‚ â”‚   ç³»ç»Ÿæ§åˆ¶é¢æ¿   â”‚  â”‚
â”‚  â”‚    30 FPS      â”‚ â”‚   åæ ‡æ ‡æ³¨      â”‚ â”‚   çŠ¶æ€ç›‘æ§      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ FFI/Socket é€šä¿¡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      C++ åç«¯å¼•æ“                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  TensorRTå¼•æ“   â”‚ â”‚  GStreamerç®¡é“   â”‚ â”‚  ModbusæœåŠ¡å™¨   â”‚  â”‚
â”‚  â”‚  AIæ¨ç†åŠ é€Ÿ     â”‚ â”‚  æ‘„åƒå¤´ç¡¬ä»¶åŠ é€Ÿ   â”‚ â”‚  PLCé€šä¿¡åè®®    â”‚  â”‚
â”‚  â”‚  <33mså»¶è¿Ÿ     â”‚ â”‚  å¤šçº¿ç¨‹å¤„ç†     â”‚ â”‚  <10mså“åº”     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚          â”‚                      â”‚                      â”‚      â”‚
â”‚      åæ ‡æ•°æ®                è§†é¢‘æµ                 å¯„å­˜å™¨æ•°æ®   â”‚
â”‚          â”‚                      â”‚                      â”‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                      â”‚                      â”‚
             â–¼                      â–¼                      â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   AIæ¨¡å‹ä¼˜åŒ–     â”‚    â”‚   ç¡¬ä»¶åŠ é€Ÿ       â”‚    â”‚   PLCè®¾å¤‡        â”‚
   â”‚ â€¢ GhostConv     â”‚    â”‚ â€¢ DeepStream    â”‚    â”‚ â€¢ Modbus TCP    â”‚
   â”‚ â€¢ GSConv        â”‚    â”‚ â€¢ V4L2/CSI      â”‚    â”‚ â€¢ å¯„å­˜å™¨æ˜ å°„     â”‚
   â”‚ â€¢ VoV-GSCSP     â”‚    â”‚ â€¢ é›¶æ‹·è´å¤„ç†     â”‚    â”‚ â€¢ å¿ƒè·³ç›‘æ§       â”‚
   â”‚ â€¢ NAMæ³¨æ„åŠ›     â”‚    â”‚ â€¢ å¸§ç¼“å†²ç®¡ç†     â”‚    â”‚ â€¢ æŒ‡ä»¤å“åº”       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”„ æ•°æ®æµå‘è¯´æ˜

1. **ğŸ“¹ è§†é¢‘é‡‡é›†**: GStreamerç¡¬ä»¶åŠ é€Ÿç®¡é“é‡‡é›†1920x1080@30fpsè§†é¢‘æµ
2. **ğŸ§  AIæ¨ç†**: TensorRTå¼•æ“å®æ—¶æ£€æµ‹ç«¹èŠ‚ä½ç½®ï¼Œè¾“å‡ºåæ ‡æ•°æ®  
3. **ğŸ“¡ æ•°æ®æ¨é€**: ModbusæœåŠ¡å™¨å°†åæ ‡å†™å…¥å¯„å­˜å™¨ï¼Œè®¾ç½®å°±ç»ªæ ‡å¿—
4. **ğŸ”„ PLCè½®è¯¢**: PLCå®šæœŸè¯»å–å¯„å­˜å™¨ï¼Œè·å–æœ€æ–°åæ ‡æ•°æ®
5. **ğŸ“± ç•Œé¢æ˜¾ç¤º**: Flutterå‰ç«¯é€šè¿‡FFIè·å–å®æ—¶è§†é¢‘å’Œæ£€æµ‹ç»“æœ

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### C++ åç«¯
- **æ¨ç†å¼•æ“**: TensorRT 8.x, OpenCV DNN (fallback)
- **æ‘„åƒå¤´å¤„ç†**: GStreamer 1.0, DeepStream SDK (Jetson)
- **é€šä¿¡åè®®**: Modbus TCP (åŸºäºIEEE 802.3ä»¥å¤ªç½‘æ ‡å‡†)
- **ç½‘ç»œæ¶æ„**: å®¢æˆ·ç«¯-æœåŠ¡å™¨æ¨¡å¼ï¼Œæ”¯æŒè¯·æ±‚-å“åº”å’Œå‘å¸ƒ-è®¢é˜…æ¨¡å¼
- **æ„å»ºç³»ç»Ÿ**: CMake 3.16+, GCC 9+
- **æ ‡å‡†å…¼å®¹**: éµå¾ªå·¥ä¸šä»¥å¤ªç½‘å’ŒModbus Application Protocolè§„èŒƒ

### Flutter å‰ç«¯
- **UIæ¡†æ¶**: Flutter 3.16+ (Embedded Linux)
- **çŠ¶æ€ç®¡ç†**: Provider + BLoC
- **é€šä¿¡**: FFI (C++ ç»‘å®š), WebSocket
- **å¹³å°**: Linux Desktop/Embedded

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. è‡ªåŠ¨åŒ–æ„å»ºéƒ¨ç½²

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url> bamboo-cut-develop
cd bamboo-cut-develop

# ä¸€é”®æ„å»º (x86_64)
./deploy/scripts/build_and_deploy.sh --install-deps --arch x86_64

# Jetson ARM64æ„å»º
./deploy/scripts/build_and_deploy.sh --install-deps --tensorrt --arch aarch64

# äº¤å‰ç¼–è¯‘ARM64
./deploy/scripts/build_and_deploy.sh --cross-compile --arch aarch64
```

### 2. éƒ¨ç½²å®‰è£…

```bash
# æœ¬åœ°å®‰è£…
./deploy/scripts/build_and_deploy.sh --deploy local

# éƒ¨ç½²åˆ°Jetson
./deploy/scripts/build_and_deploy.sh --deploy jetson

# éƒ¨ç½²åˆ°è¿œç¨‹è®¾å¤‡
./deploy/scripts/build_and_deploy.sh --deploy remote:192.168.1.100
```

### 3. å¯åŠ¨ç³»ç»Ÿ

```bash
# systemdæœåŠ¡
sudo systemctl start bamboo-cut
sudo systemctl status bamboo-cut

# ç›´æ¥è¿è¡Œ
cd /opt/bamboo-cut
./start_bamboo_cut.sh
```

## âš™ï¸ é…ç½®è¯´æ˜

### ç³»ç»Ÿé…ç½® (`config/system_config.yaml`)

```yaml
# ç¡¬ä»¶é…ç½®
hardware:
  camera:
    device_id: "/dev/video0"
    width: 1920
    height: 1080

# é€šä¿¡é…ç½®
communication:
  server_ip: "192.168.1.10"
  server_port: 502

# AIé…ç½®
ai:
  model_path: "/opt/bamboo-cut/models/bamboo_detection.onnx"
  use_tensorrt: true
```

## ğŸ“Š æ€§èƒ½åŸºå‡†

### Jetson Xavier NX
- **AIæ¨ç†**: 30+ FPS, <33mså»¶è¿Ÿ
- **æ‘„åƒå¤´**: 30 FPS, <16mså»¶è¿Ÿ
- **ç³»ç»Ÿè´Ÿè½½**: CPU <30%, å†…å­˜ <1GB

### x86_64 å·¥æ§æœº
- **AIæ¨ç†**: 15+ FPS, <66mså»¶è¿Ÿ
- **ç³»ç»Ÿè´Ÿè½½**: CPU <50%, å†…å­˜ <2GB

## ğŸ“¡ PLCé€šä¿¡åè®®

åŸºäº**Modbus TCP**çš„é«˜æ€§èƒ½å·¥ä¸šé€šä¿¡ï¼Œé‡‡ç”¨"è§†è§‰æ¨é€ï¼ŒPLCè½®è¯¢"çš„æ•°æ®äº¤æ¢æ¨¡å¼ã€‚

### ğŸ”— é€šä¿¡æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     Modbus TCP      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       PLC       â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚   è§†è§‰ç³»ç»Ÿ       â”‚
â”‚   (å®¢æˆ·ç«¯)       â”‚    192.168.1.10     â”‚   (C++æœåŠ¡ç«¯)    â”‚
â”‚                 â”‚      ç«¯å£:502       â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### â±ï¸ é€šä¿¡æ—¶åºæµç¨‹

#### 1. è¿æ¥å»ºç«‹ä¸å¿ƒè·³ç»´æŒ
```
PLC â†’ è§†è§‰ç³»ç»Ÿ: TCPè¿æ¥ (192.168.1.10:502)
PLC â†’ è§†è§‰ç³»ç»Ÿ: å¿ƒè·³å†™å…¥ (40001å¯„å­˜å™¨, æ¯2ç§’)
è§†è§‰ç³»ç»Ÿ â†’ å†…éƒ¨: ç›‘æ§å¿ƒè·³å˜åŒ–ï¼Œæ›´æ–°è¿æ¥çŠ¶æ€
```

#### 2. æ•°æ®æ¨é€ä¸è½®è¯¢
```
æ‘„åƒå¤´ â†’ AIå¼•æ“: å®æ—¶è§†é¢‘æµ
AIå¼•æ“ â†’ ModbusæœåŠ¡: æ¨é€æ£€æµ‹ç»“æœ
ModbusæœåŠ¡: æ›´æ–°åæ ‡å¯„å­˜å™¨ (40101-40148)
ModbusæœåŠ¡: è®¾ç½®å°±ç»ªæ ‡å¿— (40148=1)

å¾ªç¯è½®è¯¢:
PLC â†’ è§†è§‰ç³»ç»Ÿ: è¯»å–å°±ç»ªæ ‡å¿— (40148)
å¦‚æœ å°±ç»ªæ ‡å¿—=1:
    PLC â†’ è§†è§‰ç³»ç»Ÿ: è¯»å–åæ ‡æ•°æ® (40101-40147)
    PLC â†’ è§†è§‰ç³»ç»Ÿ: æ¸…é™¤å°±ç»ªæ ‡å¿— (40148=0)
```

#### 3. PLCæŒ‡ä»¤å¤„ç†
```
PLC â†’ è§†è§‰ç³»ç»Ÿ: å†™å…¥æŒ‡ä»¤ç  (40003å¯„å­˜å™¨)
è§†è§‰ç³»ç»Ÿ: è¯»å–å¹¶å¤„ç†æŒ‡ä»¤
è§†è§‰ç³»ç»Ÿ: æ¸…é™¤æŒ‡ä»¤ç  (40003=0)
è§†è§‰ç³»ç»Ÿ: æ‰§è¡Œç›¸åº”åŠ¨ä½œ (é€æ–™/åˆ‡å‰²/æ€¥åœç­‰)
```

### ğŸ“Š æ ¸å¿ƒå¯„å­˜å™¨æ˜ å°„

| å¯„å­˜å™¨ | åŠŸèƒ½ | ç±»å‹ | è¯´æ˜ |
|--------|------|------|------|
| 40001 | PLCå¿ƒè·³è®¡æ•°å™¨ | UINT16 | PLCæ¯2ç§’é€’å¢ |
| 40002 | è§†è§‰ç³»ç»ŸçŠ¶æ€ | UINT16 | 0=åˆå§‹åŒ–, 100=å°±ç»ª, 200+=é”™è¯¯ |
| 40003 | PLCæŒ‡ä»¤å¯„å­˜å™¨ | UINT16 | 1=é€æ–™, 3=åˆ‡å‰², 99=æ€¥åœ |
| 40101 | åˆ‡ç‚¹æ•°é‡ | UINT16 | æ£€æµ‹åˆ°çš„åˆ‡ç‚¹æ•°é‡(0-10) |
| 40102+ | åæ ‡æ•°æ® | FLOAT32 | IEEE754æ ¼å¼ï¼Œå•ä½:mm |
| 40148 | åæ ‡å°±ç»ªæ ‡å¿— | UINT16 | 1=æ–°æ•°æ®, PLCè¯»å–åæ¸…é›¶ |

### ğŸš€ æ€§èƒ½ç‰¹æ€§

- **å“åº”å»¶è¿Ÿ**: < 10ms (å±€åŸŸç½‘ç¯å¢ƒ)
- **å¹¶å‘æ”¯æŒ**: 10+ PLCåŒæ—¶è¿æ¥
- **æ•°æ®åå**: 1000+ åæ ‡/ç§’
- **å¯é æ€§**: å¿ƒè·³ç›‘æ§ + è‡ªåŠ¨é‡è¿

**è¯¦ç»†æ–‡æ¡£:**
- [C++ç‰ˆPLCé€šä¿¡åè®®æ–‡æ¡£](docs/cpp_plc_communication_protocol.md) - å®Œæ•´åè®®è§„èŒƒ
- [å·¥ä¸šé€šä¿¡æ ‡å‡†æŠ€æœ¯è§„èŒƒ](docs/industrial_communication_standards.md) - æŠ€æœ¯å®ç°ç»†èŠ‚

## ğŸ”§ å¼€å‘æŒ‡å—

### æ„å»ºç¯å¢ƒ

```bash
# Ubuntu/Debianä¾èµ–
sudo apt install build-essential cmake git pkg-config
sudo apt install libopencv-dev libgstreamer1.0-dev libmodbus-dev

# Jetsoné¢å¤–ä¾èµ–
sudo apt install nvidia-jetpack  # TensorRT + DeepStream
```

### é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ cpp_backend/           # C++åç«¯æºç 
â”œâ”€â”€ flutter_frontend/      # Flutterå‰ç«¯æºç 
â”œâ”€â”€ deploy/               # éƒ¨ç½²è„šæœ¬å’Œé…ç½®
â”œâ”€â”€ docs/                 # æŠ€æœ¯æ–‡æ¡£
â””â”€â”€ config/               # ç³»ç»Ÿé…ç½®
```

## ğŸ“ˆ ç‰ˆæœ¬å†å²

- **v2.0.0** (å½“å‰ç‰ˆæœ¬) - C++/Flutterå…¨æ–°æ¶æ„é‡æ„
- **v1.x.x** - Pythonç‰ˆæœ¬ (å·²åºŸå¼ƒ)

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Forké¡¹ç›®ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- ğŸ“§ é‚®ç®±: support@bamboo-cut.com
- ğŸ“š æ–‡æ¡£: https://docs.bamboo-cut.com
- ğŸ› é—®é¢˜åé¦ˆ: GitHub Issues

---

**æ™ºèƒ½åˆ‡ç«¹æœº v2.0 - å·¥ä¸š4.0æ™ºèƒ½åˆ¶é€ è§£å†³æ–¹æ¡ˆ** ğŸ­âš¡ 